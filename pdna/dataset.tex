\section{Datasets}
We collected structural data from the Protein Data Bank (PDB) \citep{Berman2000} and binding specificity data from JASPAR (version 2022) \citep{Jaime2022}  and HOCOMOCO (v11 core collection) \citep{kulakovskiy2018hocomoco}. JASPAR catalogues a comprehensive set of experimental binding specificity data for proteins from different species obtained through various types of experimental platforms. HOCOMOCO consists of mainly chromatin immunoprecipitation followed by sequencing (ChIP-seq) \citep{Park2009} data for human and mouse proteins.
\par
Next, we searched for protein-DNA co-crystal structures available in the PDB (Dec 2022) for each position weight matrix (PWM) available to us using corresponding UniProt IDs. We employed DSSR \citep{lu2015dssr} to check for and annotate the existence of one contiguous double helical region in these structures. In our application, we focused on double-stranded DNA only and discarded structures that did not conform to this requirement. Base modifications were replaced by their parent base identity. A total of 1,155 PDB chain IDs were filtered into the dataset. For each structure (biological assembly containing a chain of interest) in the dataset, a corresponding PWM was paired with it. If a PWM existed in both JASPAR20222 and HOCOMOCOv113, one was randomly chosen. PWMs were trimmed to remove uninformative terminal regions with a 0.5 information content (IC) threshold. For each structure, we aligned the corresponding PWM to the DNA helix using an ungapped local alignment (Supplementary Section 2), annotating the region on the DNA helix where predictions should be made and the loss computed during training. For source code and further details of data cleaning and pre-processing, see the Data/Code Availability section.
\par
We clustered the protein chains using CD-HITv4.8.1 \citep{fu2012cd} with a 40\% sequence similarity threshold for clustering, resulting in 189 clusters. This step ensures that our dataset does not overrepresent any particular protein sequence. Next, we sampled up to five members from each cluster, prioritizing biological assemblies where the chain of interest has more contacts with the DNA region where the PWM was aligned into a fold. Full list of these memberships is available in Extended Data. We set the cutoff for alignment length to be at least five base pairs. We split this set of structures into five folds to create a cross-validation set. A schematic representation of this process is shown in Fig. S1a. Experimental and species diversity of the gathered cross-validation dataset are shown in Fig. S1b.
\par
Structures that were not included in the cross-validation dataset were resampled, selecting up to five per cluster following the same criterion. This resulted in 130 datapoints, which we used as a benchmark set. Predictions on this set were only calculated once, after finalizing all models. The family distribution of this set (Fig. 2c) differs from that of the cross-validation set (Fig. S5b).
\par
The PWM of the same protein differed slightly between JASPAR2 and HOCOMOCO3 (example shown in Fig. S1c for human estrogen receptor). This observation indicates that there is an inherent limit on what can be possibly learned, signifying noise in collected knowledge. To quantify the performance limit on the dataset based on this phenomenon, we computed the distribution of performance metrics across all unique PWMs appearing in both databases (111 cases). 
\par
Alanine scanning mutagenesis involves measuring changes in binding free energy () when performing the same binding experiment for a given protein, with a specific residue mutated to alanine. We used an already gathered dataset \citep{Peng2018} of alanine scanning mutagenesis experiments for protein-DNA structures. We filtered the dataset to make it suitable for our context. Specifically, we removed cases involving single-stranded DNA. Mutations to alanine residues with  values within 0–3 kcal/mol were retained. We removed cases in which no heavy atom of the mutated residue was within 5 Å of DNA, because our model only assigns importance scores within this range. The final dataset is summarized in Table S1.
