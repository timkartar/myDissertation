\section{Introduction}
Structural complexity of RNA molecules is vast and so are their modes of interaction with proteins \citep{jones2001protein}. Although there has been an ever-expanding repertoire of structural data on the PDB, there is a lack of data resources which systematically analyze these interactions. In addition, recent advances in artificial intelligence have made high throughput prediction of protein-RNA complex structures viable \citep{Abramson2024, watson2023novo}. RNAproDB is a webserver where a user can upload a protein-RNA complex and explore analyzed results covering a multitude of aspects (e.g., direct and water-mediated hydrogen bonds, base-pairing annotations, nucleotide modifications, secondary structural features). Compared to existing resources, which often focus on the RNA structure alone and provide a particular way of visualization \citep{Kerpedjiev2015, Yang2003}, or use a representation which is very coarse-grained \citep{chojnowski2014rna}, RNAproDB provides three different algorithms for visualizing the RNA topology along with the interacting protein residues: a new design based on partial projection of the structure (RNA and interacting protein residues), tertiary structure aware mapping \citep{Mitra2024rnascape}, secondary structure-based mapping \citep{Kerpedjiev2015}. This information is presented via a highly interactive interface explorer combined with sequence and 3D-structure viewers, and a secondary structure selector. Tabular data is also available. Another novel functionality, subgraph exploration, allows a user to explore parts of the structure (e.g., a particular junction region) via the interface explorer. Subgraph selections can be manually entered or automatically selected from the secondary structure selector. As of our knowledge, no existing tool offers such capability. In addition to the webserver, we offer pre-analyzed structures containing RNA, from the PDB, in the form of a searchable collection. With a cutoff of 10,000 monomers per biological assembly and molecular weight cut off of 800 kDa on the asymmetric unit, the initial collection of RNAproDB provides around 3,500 biological assemblies containing RNA molecules. RNAproDB will be automatically updated weekly with new PDB entries. We believe RNAproDB will be a valuable resource for the scientific community interested in RNA biology, protein-nucleic acid interaction and function, structure prediction, and drug design.

\begin{center}
    \begin{figure}
    \makebox[\textwidth]{\includegraphics[width=0.8\paperwidth]{./rnaprodbfigs/fig1.png}}
 % archetecture.png: 1149x508 px, 72dpi, 40.53x17.92 cm, bb=0 0 1149 508
        \caption[Key aspects of this update to DNAproDB.]{\textbf{Key aspects of this update to DNAproDB.} ({\bf A}) Automatic update and separated external annotation incorporation scheme.  ({\bf B})  Different nucleic acid layout options in with added tertiary structure aware RNAscape layout, shown for PDB ID: 3LDY. ({\bf C}) Water-mediated hydrogen bond annotation. ({\bf D}) Various improvements in other aspects of DNAproDB. }
  \label{fig:rnaprodb1}
\end{figure}
\end{center}

\section{Processing pipeline}
The RNAproDB processing pipeline starts with a structure and computes multiple visualizations and interaction information from it. As part of the processing piepline multiple softwares are run, which include X3DNA-DSSR (\citep{Lu2015}computes base-pairing geometries, protein-RNA hydrogen bonds and RNA secondary structure), HBPLUS (McDonald1994to compute hydrogen bonds involving water molecules), RNAscape (\citep{Mitra2024rnascape} tertiary structure aware nucleotide mapping), ViennaRNA (\citep{Lorenz2011} secondary structure-based nucleotide mapping), DSSP (\citep{joosten2010series, kabsch1983dictionary} computes protein secondary structure). In addition, custom code has been developed to compute a new ``Partial Projection" based mapping for the nucleotides. The processing piepleine combines all these data into a graph object which is used to compute highly interactive frontend presentation of the structure. This frontend presentation is an intertwined experience of an Interface Explorer, a 3D Viewer, a secondary structure selector, a Sequence viewer and Tabular data. In the next sections we describe the functionalities implemented through these components.

\section{Interface explorer}

The 'Interface explorer' for RNAproDB is freshly designed to present an interaction graph of the RNA structure along with interacting protein residues. The explorer present three different layout algorithm options, selectable by the user. two of these options are secondary structure based (computed using ViennaRNA \citep{Lorenz2011}) and tertiary structure aware mapping based (computed using RNAscape \citep{Mitra2024rnascape}). The third (default) option is a new mapping scheme produced by prjecting the RNA residues and only interacting protein residues into the 2D plane maximizing their spatial variance \citep{Pearson1901}. We call this method ``Partial projection" (instead of the whole structure, it only projects the RNA and interacting protein components). In our observation, this scheme is visually intuitive for exploring corresponding 3D structure. The user is free to choose between the three layouts. In each case, the protein residues are placed using a force directed layout scheme \citep{bostock2012fl}. We demonstrate the three layout schemes for a valyl-tRNA synthetase-tRNA complex (PDB ID: 1IVS) (\blue{Fig. \ref{fig:rnaprodb1}A}). The partial projection-based layout is shown in \blue{Fig. \ref{fig:rnaprodb1}B}. This layout reflects the helical turns, making the best coreespondance with the 3D structure. The RNAscape \citep{Mitra2024rnascape} layout (\blue{Fig. \ref{fig:rnaprodb1}C}) is cleaner and more suitable for users used to a ladder-like representation.  The secondary structure based layout, shown in \blue{Fig. \ref{fig:rnaprodb1}D}, although familiar, suffers from tertiary interactions within RNA and protein-RNA interactions criss-crossing the view. Options to turn off tertiary interaction edges and protein interactions have been implemented to help with this situation, in case a user wants a clean view of the secondary structure. This is demonstrated in \blue{Fig. \ref{fig:rnaprodb2}A-C}). Another useful feature of the interface explorer is the ability to change distance theshold of visible protein-RNA interactions on the fly. This threshold can be modified using a slider, and upon modification, edge distances that fall beyond the threshold are hidden. At any point of the exploration, the user is able to download the visualization as a static picture, a scalable vector graphic format image or download the corresponding graphical data.


\begin{center}
    \begin{figure}
    \makebox[\textwidth]{\includegraphics[width=0.8\paperwidth]{./rnaprodbfigs/fig2.png}}
 % archetecture.png: 1149x508 px, 72dpi, 40.53x17.92 cm, bb=0 0 1149 508
        \caption[Key aspects of this update to DNAproDB.]{\textbf{Key aspects of this update to DNAproDB.} ({\bf A}) Automatic update and separated external annotation incorporation scheme.  ({\bf B})  Different nucleic acid layout options in with added tertiary structure aware RNAscape layout, shown for PDB ID: 3LDY. ({\bf C}) Water-mediated hydrogen bond annotation. ({\bf D}) Various improvements in other aspects of DNAproDB. }
  \label{fig:rnaprodb2}
\end{figure}
\end{center}
\section{Secondary structure selector and subgraph exploration}

A more coarse grained diagram is also computed as part of the processing piepline for RNAproDB. This diagram reflects the different secondary structure elements as one node each, interaction edges corresponding to residues involved in one secondary structure element with another are collapsed into one edge. This view is presented to serve as a selectable by the user, named "Secondary structure selector". An example is shown for PDB ID: 1UN6 \blue{Fig. \ref{fig:rnaprodb2}D}). The corresponding Secondary structure selector is shown in \blue{Fig. \ref{fig:rnaprodb2}E}. The partial projection-based layout for this structure is presented in \blue{Fig. \ref{fig:rnaprodb2}F}. 

Whenever a user clicks a particular node (e.g. `Stem 3' in \blue{Fig. \ref{fig:rnaprodb2}E}), corresponding nucleic acid residue ids are populated into the subgraph generation dialogue. The user can now click the "Generate subgraph" button to generate and explore the subgraph (upto first order neighbors) via the interface explorer (\blue{Fig. \ref{fig:rnaprodb2}G}). Beyond clicking the secondary structure selector, a subgraph selection can also be manually entered or selected from the Sequence viewer or Interface explorer. 

\section{Search functionalities and Upload}

The pre-analyzed collection of RNAproDB contains 3500+ protein-RNA structures. In addition, RNA structures without proteins, DNA and NA-hybrid containing structures are also included. A known PDB ID can be directly searched using the qucick search box available at the top-right location of the website. More refined searches can be performed from the "Search" page. The search page allows search queries to be entered which can be author names or keywords related to the structures of interest. Additional filters can be set, which include molecule type (polymer entity type: RNA/DNA/NA-hybrid), experimental modality, resolution range, publication year, number of NA polymers, number of protein polymers, molecular weight of the biological assembly. The search results will be presented in tabular view. Optionally a card view of the search results is also available. The resulting PDB IDs can be copied to clipboard or the data can be downloaded in comma-separated value (CSV) or JavaScript object notation (JSON) format. An example search output page for the keyword search ``tetrahymena" is shown in \hyperref[fig:rnaprodbS1]{Fig. S29}.

Structure files in mmCIF format can be uploaded to the RNAproDB webserver through the upload page. Upon upload, the server will process the structure and create a custom page with the results. We hope this feature will be exceedingly valuable for people looking to analyze predicted complex structures (e.g. from AlphaFold3 \citep{Abramson2024}) of protein and nucleic acids. An example output page for AlphaFold3 predicted structure (model 0) for molecules in PDB ID: 8AW3 is shown in \hyperref[fig:rnaprodbS2]{Fig. S30}.

\section{RNA-RNA water mediated interactions}

Non-canonical base-pairing is very common in RNA structures and often they influence structural organisation of the molecule and interaction with other molecules \citep{olson2019effects}. Varied combinations of base pairings often lead to sub-optimal direct hydrogen bonds between pairs or adjacent bases. Water molecules appear to compensate such situations by making ``base-pairing" possible through water-mediated hydrogen bonds. One such example is the CUG repeat structure from PDB ID: 7Y2B (\citep{wang2023structural}, \blue{Fig. \ref{fig:rnaprodb3}A})). The U-U mismatches in this structure are often unable to form direct hydrogen bonds (specifically, the central U-U mismatch, forms no direct H-bond). Therefore, DSSR (\citep{Lu2015}) does not consider it a base-pair. However, two water molecules form water-mediated hydrogen bonds between the two U's. This has an effect on the structure, as the U-U mismatch region now has a similar base-pair width as the C-G paired regions (\blue{Fig. \ref{fig:rnaprodb2}D}), otherwise expected to be narrower in width). 

RNAproDB computes RNA-RNA water mediated hydrogen bonds to reflect such information in the interface explorer (\blue{Fig. \ref{fig:rnaprodb2}B}), which would otherwise be overlooked. We demonstrate the molecular conformation of the central U-U mismatch (\blue{Fig. \ref{fig:rnaprodb2}C}) and a off-centre U-U mismatch (\blue{Fig. \ref{fig:rnaprodb2}D})

\begin{center}
    \begin{figure}
    \makebox[\textwidth]{\includegraphics[width=0.8\paperwidth]{./rnaprodbfigs/fig3.png}}
 % archetecture.png: 1149x508 px, 72dpi, 40.53x17.92 cm, bb=0 0 1149 508
        \caption[Key aspects of this update to DNAproDB.]{\textbf{Key aspects of this update to DNAproDB.} ({\bf A}) Automatic update and separated external annotation incorporation scheme.  ({\bf B})  Different nucleic acid layout options in with added tertiary structure aware RNAscape layout, shown for PDB ID: 3LDY. ({\bf C}) Water-mediated hydrogen bond annotation. ({\bf D}) Various improvements in other aspects of DNAproDB. }
  \label{fig:rnaprodb3}
\end{figure}
\end{center}