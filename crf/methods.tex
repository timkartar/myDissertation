\section{Methods}

\subsection{A suitable smoothness metric for binding site prediction}




\subsection{Continuous Conditional Random Fields layer}

\begin{pmialgorithm}[0.9\textwidth]{H}{ Mean Field CCRF Layer}\vskip-2ex
        \label{algo:tk-means}
        \begin{algorithmic}[1]
                \REQUIRE  $B_i$  $\forall i$, $E$ (adjacency information)
                \STATE Initialize $H_i^0 = B_i$ $\forall i$\COMMENT{$H_i^0$ maximises $Q_i^0 = \frac{1}{Z_i^0}exp(-c||H_i^0 - B_i||^2)$}
                \FOR[$T$ signifies convergence]{$t=0,1,2,...,T-1$}
        \STATE compute $(\sum \limits_{j \in \mathcal{N}(i)} (g_{ij} H_j^t),\sum \limits_{j \in \mathcal{N}(i)} g_{ij})$ \COMMENT{message passing}
        \STATE $H_i^{t'} = \alpha B_{i} + \beta  \sum\limits_{j \in \mathcal{N}(i)} (g_{ij} H_j^t)$
        \STATE $H_i^{t+1} = H_i^{t'} / (\alpha +  \beta  \sum \limits_{j \in \mathcal{N}(i)} g_{ij} )$
                \ENDFOR
                \STATE $H_i^* = H_i^T$
                \RETURN $H_i^*$
        \end{algorithmic}
\end{pmialgorithm}




